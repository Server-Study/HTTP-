# 2장 URL과 리소스

HTTP 명세에서는 URI를 더 일반화된 개념의 리소스 식별자로 사용한다.

다음과 같은 URL이 있다고 할 때 세 부분을 나눌 수 있다.
```
http://www.joes-hardware.com/seasonal/index-fall.html
```

첫 부분인 http는 스킴이다.
* 웹 클라가 리소스에 어떻게 접근하는지 알려준다.

두 번째 부분인 www.joes-hardware.com은 서버의 위치다.
* 웹 클라가 리소스가 어디에 호스팅 되어 있는지 알려준다.

세 번째 부분인 /seasonal/index-fall.html은 리소스의 경로다.
* 서버에 존재하는 로컬 리소스들 중에서 요청받은 리소스가 무엇인지 알려준다.

URL을 사용하면 일관된 방식으로 지칭할 수 있다.
* 대부분의 URL은 동일하게 '스킴://서버위치/경로’ 구조로 이루어져 있다.
* 웹과 URL이 있기 전에는 애플리케이션마다 달리 가지고 있는 분류 방식을 사용했다.

### URL 문법
리소스들은 다른 스킴을 통해 접근할 수 있으며, 스킴에 따라서 문법이 달라진다.
* 대부분의 URL은 일반 URL 문법을 따르며, 서로 다른 URL 스킴도 형태와 문법 면에서 매우 유사하다.

대부분의 URL 스킴의 문법은 일반적으로 9개 부분으로 나뉜다.
```
<스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#<프래그먼트>
```

이 모든 컴포넌트를 가지는 URL은 거의 없다.
* 가장 중요한 세 가지 컴포넌트는 스킴, 호스트, 경로다.

스킴 : 사용할 프로토콜
* 주어진 리소스에 어떻게 접근하는지 알려주는 중요한 정보
* 알파벳으로 시작해야 한다.
* 대소문자를 구분하지 않는다.

호스트와 포트
* 호스트 컴포넌트는 접근하려고 하는 리소르를 가지고 있는 인터넷상의 호스트 장비를 가리킨다.
* 호스트는 (‘www.joes-hardware.com’)와 같은 호스트명이나 IP주소로 제공한다.
* 포트 컴포넌트는 서버가 열어놓은 네트워크 포트를 가리킨다.
* TCP 프로토콜을 사용하는 HTTP는 기본 포트가 80이다.

사용자 이름과 비밀번호
* 많은 서버가 자신의 데이터에 접근을 허용하기 전에 사용자 이름과 비밀번호를 요구한다.
* 값이 삽입되어 있지 않으면 애플리케이션이 기본 값을 넣어놓을 것이다.
    * 기본 사용자 이름 : ‘anonymous'
    * 비밀번호는 브라우저마다 기본값이 다르다.

경로
* 리소스가 서버의 어디에 있는지 알려준다.
* 계층적 파일 시스템 경로와 유사한 구조를 가진다.

파라미터
* 많은 스킴이 객체에 대한 호스트 및 경로 정보만으로는 리소스를 찾지 못한다.
* 이름/값 쌍의 리스트로 URL 나머지 부분들로부터 ‘;’ 문자로 구분하여 URL에 기술한다.
* 리소스에 접근하는데 필요한 어떤 추가 정보든 전달할 수 있다.
* 경로 컴포넌트는 경로조각으로 나눌 수 있는데 각 조각은 자체 파라미터를 가질 수 있다.
    * http://www.joes-hardware.com/hammers;sale=false/index.html;graphics=true

질의 문자열
* 디비 같은 서비스들은 요청받을 리소스 형식의 범위를 좁히기 위해 질의문이나 질의를 받을 수 있다.

프래그먼트
* HTML 같은 리소스 형식들은 본래의 수준보다 더 작게 나뉠 수 있다.
* 리로스 URL은 텍스트 문서 전체를 가리키지만, 리소스 안에 있는 특정 절을 가리킬 수 있다.
* URL의 오른쪽에 #문자에 이어서 온다.
* 클라는 서버에 프래그먼트를 전달하지 않고, 전체 리소스를 내려받은 후 프래그먼트를 사용해서 보여준다.
    * URL 프래그먼트는 클라에서만 사용

### 단축 URL
상대 URL은 리소스 안에 있는 리소스를 간결하게 기술하는데 사용할 수 있다.
* 많은 브라우저가 URL 일부를 입력하면 나머지 부분을 자동으로 입력해주는 URL ‘자동 확장’을 지원

상대 URL

상대 URL은 모든 정보를 담고 있지는 않다.
* 기저(base)라고 하는 다른 URL을 사용해서 리소스 접근에 필요한 모든 정보를 얻는다.

기저 URL을 찾는 몇 가지 방법
* 리소스에서 명시적으로 제공
* 리소스를 포함하고 있는 기저 URL
* 기저 URL이 없는 경우는 절대 URL로만 이루어져 있거나 불완전하거나 깨진 URL일 수도 있다.

URL 확장

어떤 브라우저들은 URL을 입력한 다음이나 입력하고 있는 동안에 자동으로 URL을 확장한다.

확장 기능은 두 가지로 나뉜다.
* 호스트명 확장
    * 단순 휴리스틱만을 사용해서 입력한 호스트 명을 전체 호스트 명으로 확장할 수 있다.
    * 예를 들어 naver를 입력하면 자동으로 www.naver.com을 만든다.
    * 만약 찾지 못하면 몇가지 URL을 추가로 제시
* 히스토리 확장
    * 과거에 사용자가 방문했던 URL의 기록을 저장해 놓는다.
    * URL을 입력하면 앞 글자들을 포함하는 완결된 형태의 URL들을 선택하게 해준다.

### 안전하지 않은 문자
어떤 인터넷 프로토콜을 통해서든 안전하게 전송될 수 있도록 URL을 설계하는 것은 중요했다.

URL 설계자들은 URL에 이진 데이터나 일반적으로 안전한 알파벳 외의 문자도 포함하려고 할 때가 있다는 것을 알게 되어서 이스케이프라는 기능을 추가해, 안전하지 않은 문자를 안전한 문자로 인코딩 할 수 있게 하였다.

URL 문자 집합

역사적으로 많은 컴퓨터 애플리케이션이 US-ASCII 문자 집합을 사용해왔다.
* 문자를 서식화하고 하드웨어상에서 신호를 주고받기 위해, 7비트를 사용하여 영문 자판에 있는 키 대부분과 몇몇 출력되지 않는 제어 문자를 표현한다.

US-ASCII가 지원하지 않는 문자와 특정 이진 데이터를 포함할 수 있게 이스케이프 문자열을 쓸 수 있도록 설계하였다.
* 이스케이프 문자열은 US-ASCII에서 사용이 금지된 문자들
* 특정 문자나 데이터를 인코딩할 수 있도록 한다.

인코딩 체계

URL에 있는 안전하지 않은 문자들을 표현할 수 있는 인코딩 방식이 고안되었다.
* %로 시작해, ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 ‘이스케이프’ 문자로 바꾼다.

문자 제한
* 몇몇 문자는 URL 내에서 특별한 의미로 예약되어 있다. 
* 어떤 문자는 US-ASCII의 출력 가능한 문자 집합에 포함되어 있지 않다.
* 어떤 문자는 몇몇 인터넷 게이트웨이와 프로토콜에서 혼동되는 것으로 알려져, 사용이 꺼려진다.
* 본래의 목적이 아닌 다른 용도로 사용하려면 반드시 인코딩해야 하는 문자들이 정해져있다.

입력받은 URL에서 어떤 문자를 인코딩해야 하는지 결정하는 데는 브라우저와 같이 사용자로부터 최초로 URL을 입력받는 애플리케이션이 하는 것이 가장 적절하다.
* 극단적인 방법은 애플리케이션이 모든 문자를 인코딩하는 것이다.

미래
* URL은 주소이지 실제 이름은 아니다.
* URL이 특정 시점에 어떤 것이 위치한 곳을 알려준다는 것을 뜻한다.
* URL은 리소스를 찾는데 필요한 포트와 서버 이름을 제공한다.
    * 이런 스킴의 단점은 리소스가 옮겨지면 URL을 더는 사용할 수 없다는 것
    * 기존 URL이 가리키고 있던 객체를 찾을 방법이 없어진다.
* 이런 문제를 해결하는 이상적인 방법을 찾아내기 위해  URN이라는 새로운 표준 작업에 착수

URL에서 URN으로 주소 체계를 바꾸는 것은 매우 큰 작업
* 표준을 제정하는 것부터 HTTP 애플리케이션을 수정하기 위한 벤더들과의 합의도 필요
* URN으로 전환하기에 시간이 오래 걸리기 때문에 URL은 당분간 계속 사용될 것